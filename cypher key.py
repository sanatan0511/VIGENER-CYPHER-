# -*- coding: utf-8 -*-
"""
Created on Mon Aug 19 12:12:36 2024

@author: rashm
"""

import string


def find_key_from_frequencies(segment_frequencies):
    common_letter = 'E'
    key = []
    
    for freq in segment_frequencies:
        most_common_letter = max(freq, key=freq.get)
        shift = (ord(most_common_letter) - ord(common_letter)) % 26
        key.append(chr(shift + ord('A')))
    
    return ''.join(key)


segment_frequencies = [
    {'A': 352426, 'B': 90854, 'C': 4528, 'D': 279997, 'E': 296816, 'F': 425455, 'G': 129307, 'H': 45879, 'I': 110976, 'J': 7052, 'K': 93191, 'L': 3570, 'M': 383264, 'N': 70394, 'O': 131292, 'P': 199916, 'Q': 597981, 'R': 104971, 'S': 94751, 'T': 286262, 'U': 328058, 'V': 7190, 'W': 36179, 'X': 189019, 'Y': 112919, 'Z': 317710},
    {'A': 112737, 'B': 317652, 'C': 352465, 'D': 90730, 'E': 4517, 'F': 281577, 'G': 297378, 'H': 424944, 'I': 129763, 'J': 45876, 'K': 110277, 'L': 7078, 'M': 92224, 'N': 3466, 'O': 383825, 'P': 70241, 'Q': 131005, 'R': 200698, 'S': 596458, 'T': 104655, 'U': 95113, 'V': 286057, 'W': 327429, 'X': 7350, 'Y': 36510, 'Z': 189932},
    {'A': 112875, 'B': 317023, 'C': 352430, 'D': 90834, 'E': 4447, 'F': 281548, 'G': 297098, 'H': 425010, 'I': 129318, 'J': 45914, 'K': 111505, 'L': 6968, 'M': 92728, 'N': 3514, 'O': 384879, 'P': 69952, 'Q': 131013, 'R': 200021, 'S': 595868, 'T': 104021, 'U': 94864, 'V': 286827, 'W': 327915, 'X': 7168, 'Y': 36532, 'Z': 189685},
    {'A': 317140, 'B': 353702, 'C': 90821, 'D': 4578, 'E': 281141, 'F': 297116, 'G': 425808, 'H': 129612, 'I': 45690, 'J': 110668, 'K': 7024, 'L': 92947, 'M': 3471, 'N': 383120, 'O': 70289, 'P': 130904, 'Q': 199677, 'R': 597970, 'S': 104157, 'T': 95096, 'U': 286307, 'V': 327474, 'W': 7066, 'X': 36481, 'Y': 188616, 'Z': 113081}
]


key = find_key_from_frequencies(segment_frequencies)
print(f"Guessed Key: {key}")
